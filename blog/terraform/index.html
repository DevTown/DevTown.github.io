<!doctype html><html lang=de-de><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Terraform | Dev-Town - IT Blog</title>
<meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Bereitstellen von Infrastruktur in der modernen IT"><meta name=generator content="Hugo 0.134.2"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.0d57100215dc76b985948a07e3f2783f4d3d3fcb8dc52381d0a6d5df0b1370c3.css><link rel=stylesheet href=/css/custom.css><link rel=canonical href=https://www.dev-town.de/blog/terraform/><meta property="og:url" content="https://www.dev-town.de/blog/terraform/"><meta property="og:site_name" content="Dev-Town - IT Blog"><meta property="og:title" content="Terraform"><meta property="og:description" content="Bereitstellen von Infrastruktur in der modernen IT"><meta property="og:locale" content="de_de"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-02-07T10:00:00+01:00"><meta property="article:modified_time" content="2024-02-07T10:00:00+01:00"><meta itemprop=name content="Terraform"><meta itemprop=description content="Bereitstellen von Infrastruktur in der modernen IT"><meta itemprop=datePublished content="2024-02-07T10:00:00+01:00"><meta itemprop=dateModified content="2024-02-07T10:00:00+01:00"><meta itemprop=wordCount content="763"><meta name=twitter:card content="summary"><meta name=twitter:title content="Terraform"><meta name=twitter:description content="Bereitstellen von Infrastruktur in der modernen IT"><script defer data-domain=dev-town.de src=https://plausible.dev-services.de/js/plausible.js></script></head><body class="ma0 avenir bg-near-white production"><header class="cover bg-top" style=background-image:url(https://www.dev-town.de/images/terraform.jpg)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Dev-Town - IT Blog</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/ title="Home Seite">Home</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/blog/ title="Blogs Seite">Blogs</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/datenschutz/ title="Datenschutzerklärung Seite">Datenschutzerklärung</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/impressum/ title="Impressum Seite">Impressum</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="Über mich Seite">Über mich</a></li></ul><div class=ananke-socials><a href=https://github.com/DevTown target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://chaos.social/@dev_town target=_blank rel=noopener class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" aria-label="follow on Mastodon——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67"><path d="M61.731833 16.783448C60.855064 10.336694 55.17491 5.2562169 48.441526 4.2717554 47.305526 4.1054038 43.001372 3.5 33.030833 3.5h-.07446c-9.973232.0-12.112924.6054038-13.248924.7717554C13.161526 5.2289477 7.1836569 9.7940169 5.7332999 16.317063c-.6976035 3.212462-.7720515 6.774-.6424569 10.041.1847407 4.685077.2205861 9.361923.6507292 14.027923.2973693 3.099385.8161231 6.174077 1.552377 9.201 1.3786615 5.590462 6.9594998 10.242769 12.4272688 12.140846 5.854077 1.979385 12.149615 2.307923 18.181846.949.663539-.152692 1.319846-.33 1.968693-.531769 1.464153-.460846 3.182-.976308 4.444846-1.881692.01731-.01269.03154-.02908.04154-.048.01-.01885.01562-.03977.01631-.06108v-4.521385c-308e-6-.01992-.0051-.03954-.014-.05738-.009-.01785-.02185-.03354-.03777-.04577-.01585-.01231-.03431-.02092-.05392-.02531-.01969-.0043-.04008-.0042-.05969 23e-5-3.864769.913077-7.825154 1.370769-11.798615 1.363539-6.838154.0-8.677308-3.209693-9.204-4.546-.423308-1.154846-.692154-2.359462-.799615-3.583308-.0011-.02054.0028-.04108.01115-.05992.0084-.01877.02123-.03538.03731-.04839.01615-.013.03515-.02208.05546-.02646.02031-.0045.04138-.004.06154.0012 3.800385.906846 7.696154 1.364538 11.605615 1.363538.940231.0 1.877693.0 2.818-.02454 3.931923-.109077 8.076154-.308154 11.944693-1.055385.09654-.01908.193-.03546.275769-.06 6.101923-1.159 11.908846-4.796846 12.498923-14.008846.02208-.362692.07723-3.798769.07723-4.175077.0028-1.279.416384-9.072846-.06069-13.861538zm-9.391461 22.98623H45.924141V24.225525c0-3.272462-1.378692-4.941385-4.182923-4.941385-3.082692.0-4.626769 1.974385-4.626769 5.874v8.508385H30.736757V25.15814c0-3.899615-1.546847-5.874-4.629539-5.874-2.787692.0-4.180154 1.668923-4.182923 4.941385V39.769678H15.513526V23.753755c0-3.272461.844692-5.87223 2.534-7.799384 1.742615-1.922539 4.028461-2.909693 6.865769-2.909693 3.283923.0 5.765538 1.248923 7.419923 3.744231l1.596539 2.650692 1.59923-2.650692c1.654385-2.495308 4.136-3.744231 7.414462-3.744231 2.834538.0 5.120308.987154 6.868461 2.909693 1.689385 1.925307 2.534 4.525077 2.534 7.799384z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://dev-town.de/index.xml target=_blank rel=noopener class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" aria-label="follow on RSS——Opens in a new window"><span class=icon><svg viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><div class="f2 f1-l fw2 white-90 mb0 lh-title">Terraform</div><div class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">Bereitstellen von Infrastruktur in der modernen IT</div></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Blogs</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Terraform</h1><time class="f6 mv4 dib tracked" datetime=2024-02-07T10:00:00+01:00>Februar 7, 2024</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h2 id=was-ist-terraform-lauf-chatgpt>Was ist Terraform lauf ChatGPT:</h2><p>Terraform ist ein &ldquo;Infrastructure as Code&rdquo; (IaC) Tool, das von HashiCorp entwickelt wurde. Es ermöglicht die Definition, Bereitstellung und Verwaltung von Infrastrukturressourcen auf deklarative Weise. Mit Terraform können Sie Ihre Infrastruktur als Code schreiben, was bedeutet, dass Sie die gesamte Struktur Ihrer IT-Infrastruktur in einer einzigen Konfigurationsdatei abbilden können. Durch die Verwendung von Terraform können Teams Infrastrukturänderungen versionieren, gemeinsam bearbeiten und auf kontrollierte und reproduzierbare Weise implementieren. Dies erleichtert die Automatisierung und Skalierung von Infrastrukturmanagementaufgaben.</p><h2 id=und-was-bedeutet-das-nun-genau>Und was bedeutet das nun genau?</h2><p>Infrastructure as Code (IaC) ist das Werkzeug, das meiner Meinung nach den Ops-Bereich näher an den Dev-Bereich gebracht hat.</p><p>Es wird nicht wie früher jeder Server einzeln von Hand aufgesetzt, sondern mit Code (Deklaration eines gewünschten Zustandes) beschrieben, wie der neue Server, die ganze Serverfarm aussehen soll.</p><pre><code>Ich hätte gerne 10 Webserver, 2 DB-Server 
und noch einen kleinen FTP-Server.
</code></pre><p>Und mit einem einzigen Befehl werden alle Server auf Basis des entsprechenden Basis-Images mit Terraforming in die Cloud oder auf die eigene Virtualisierungsumgebung ausgerollt.</p><pre><code>Ach alle Server sollen nicht nur 8GB sondern 100GB RAM bekommen? 
Kein Problem.
</code></pre><p>Die Config wird angepasst, gepusht und Terraform kümmert sich um die Aktualisierung aller virtuellen Umgebungen.</p><p>Alles nachvollziehbar in der Regel in GIT abgelegt, damit auch morgen noch jeder weiß, was wann geändert wurde.</p><h3 id=und-wie-sieht-so-eine-config-aus>Und wie sieht so eine Config aus?</h3><p>Ein Beispiel aus meinem Homelab für ein Grafana sieht wie folgt aus:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#66d9ef>provider</span> <span style=color:#e6db74>&#34;proxmox&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_api_url</span> = var.<span style=color:#a6e22e>proxmox_host</span>[<span style=color:#e6db74>&#34;pm_api_url&#34;</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_user</span> = var.<span style=color:#a6e22e>proxmox_host</span>[<span style=color:#e6db74>&#34;pm_user&#34;</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_password</span> = var.<span style=color:#a6e22e>userpw</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_tls_insecure</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;proxmox_lxc&#34;</span> <span style=color:#e6db74>&#34;ProxMox-Grafana&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>count</span>        = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>target_node</span>  = <span style=color:#e6db74>&#34;lpve&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hostname</span>     = <span style=color:#e6db74>&#34;lxc-test&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ostemplate</span>   = <span style=color:#e6db74>&#34;local:vztmpl/ubuntu-22.10-standard_22.10-1_amd64.tar.zst&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span>     = var.<span style=color:#a6e22e>lxcpw</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>unprivileged</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cores</span> = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>memory</span> = <span style=color:#ae81ff>2048</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>start</span> = <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ssh_public_keys</span> = file(var.<span style=color:#a6e22e>ssh_keys</span>[<span style=color:#e6db74>&#34;pub&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rootfs</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>storage</span> = <span style=color:#e6db74>&#34;local-lvm&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span>    = <span style=color:#e6db74>&#34;8G&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>network</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ip</span> = format(<span style=color:#e6db74>&#34;%s/24&#34;</span>, var.<span style=color:#a6e22e>ips</span>[count.<span style=color:#a6e22e>index</span>])
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span>   = <span style=color:#e6db74>&#34;eth0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bridge</span> = <span style=color:#e6db74>&#34;vmbr0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>gw</span> = cidrhost(format(<span style=color:#e6db74>&#34;%s/24&#34;</span>, var.<span style=color:#a6e22e>ips</span>[count.<span style=color:#a6e22e>index</span>]), <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  }<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  #creates ssh connection to check when the CT is ready for ansible provisioning
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>connection</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>host</span> = var.<span style=color:#a6e22e>ips</span>[count.<span style=color:#a6e22e>index</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>user</span> = <span style=color:#e6db74>&#34;root&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>agent</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>timeout</span> = <span style=color:#e6db74>&#34;5m&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>Etwas zerlegt sieht die Datei wie folgt aus:</p><p>Der Provider definiert, wie Terraform mit wem sprechen soll.
In diesem Fall sage ich ihm, dass ich mit meinem Proxmox sprechen möchte und gebe ihm die entsprechenden
die entsprechenden Parameter mit, die dieser Provider braucht.
Natürlich nicht im Klartext, sondern als Parameter in einer eigenen Datei oder als Übergabeparameter.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#66d9ef>provider</span> <span style=color:#e6db74>&#34;proxmox&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_api_url</span> = var.<span style=color:#a6e22e>proxmox_host</span>[<span style=color:#e6db74>&#34;pm_api_url&#34;</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_user</span> = var.<span style=color:#a6e22e>proxmox_host</span>[<span style=color:#e6db74>&#34;pm_user&#34;</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_password</span> = var.<span style=color:#a6e22e>userpw</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pm_tls_insecure</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>Die &ldquo;Ressource&rdquo; definiert nun den eigentlichen Server. Also wie viel RAM, CPU und HDD soll der Server nun bekommen.
Wichtig ist hier noch das Flag &ldquo;count = 1&rdquo; zu erwähnen. Hier könnte man auch 10 angeben, dann würden hier sofort 10 Instanzen des auf dem Proxmox starten. Und genau hier liegt einer der großen Vorteile. Man muss nur einmal sagen, wie der Web- oder DB-Server aufgebaut sein soll und kann diesen ohne großen Aufwand einfach X-Fach ausrollen.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;proxmox_lxc&#34;</span> <span style=color:#e6db74>&#34;ProxMox-Grafana&#34;</span> {
</span></span><span style=display:flex><span> <span style=color:#a6e22e>count</span>        = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>target_node</span>  = <span style=color:#e6db74>&#34;lpve&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hostname</span>     = <span style=color:#e6db74>&#34;lxc-test&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ostemplate</span>   = <span style=color:#e6db74>&#34;local:vztmpl/ubuntu-22.10-standard_22.10-1_amd64.tar.zst&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span>     = var.<span style=color:#a6e22e>lxcpw</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>unprivileged</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cores</span> = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>memory</span> = <span style=color:#ae81ff>2048</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>start</span> = <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ssh_public_keys</span> = file(var.<span style=color:#a6e22e>ssh_keys</span>[<span style=color:#e6db74>&#34;pub&#34;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rootfs</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>storage</span> = <span style=color:#e6db74>&#34;local-lvm&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span>    = <span style=color:#e6db74>&#34;8G&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>network</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ip</span> = format(<span style=color:#e6db74>&#34;%s/24&#34;</span>, var.<span style=color:#a6e22e>ips</span>[count.<span style=color:#a6e22e>index</span>])
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span>   = <span style=color:#e6db74>&#34;eth0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bridge</span> = <span style=color:#e6db74>&#34;vmbr0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>gw</span> = cidrhost(format(<span style=color:#e6db74>&#34;%s/24&#34;</span>, var.<span style=color:#a6e22e>ips</span>[count.<span style=color:#a6e22e>index</span>]), <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  }<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  #creates ssh connection to check when the CT is ready for ansible provisioning
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>connection</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>host</span> = var.<span style=color:#a6e22e>ips</span>[count.<span style=color:#a6e22e>index</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>user</span> = <span style=color:#e6db74>&#34;root&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>agent</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>timeout</span> = <span style=color:#e6db74>&#34;5m&#34;</span>
</span></span><span style=display:flex><span>  }</span></span></code></pre></div><p>Am Ende können wir das noch mit dem Befehl</p><pre><code>terraform plan
</code></pre><p>testen, um hier genau zu sehen was er ausführen (erstellen, updaten oder löschen) würde.</p><p>Wenn wir damit zufrieden sind, könnten wir das ganze ganz einfach mit</p><pre><code>terraform apply
</code></pre><p>ausführen.</p><h2 id=fazit>Fazit</h2><p>Terraform ermöglicht es uns in der modernen IT-Welt sehr einfach und komfortabel virtuelle Server in vielfacher Anzahl einzusetzen und zu verwalten. Das Ganze nicht nur mit einer Person sondern auch über ein ganzes Team hinweg, denn Terraform merkt sich auch den Zustand des Systems, damit es für spätere Ausführungen auch weiß, ob eventuell ein Server, aus welchen Gründen auch immer, fehlt und neu erstellt werden muss oder ob eventuell die CPU Anzahl nicht passt und diese geändert werden muss. D.h. selbst wenn ein Admin auf die Idee käme den Arbeitsspeicher eines Servers zu verdoppeln, würde dies nach der Ausführung von Terraform angepasst werden.</p><p>Hier macht sich der deklarative Ansatz bemerkbar. Wir sagen hier nicht WIE der Server erstellt werden soll, sondern nur WIE er später aussehen soll. Alles andere ist dann Sache von Terraform und dem entsprechenden Provider.</p><h2 id=links>Links</h2><p><a href=https://www.terraform.io/>www.terraform.io</a></p><hr><p>Image from <a href=https://www.freepik.com>www.freepik.com</a></p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://www.dev-town.de/>&copy; Dev-Town.de All rights reserved 2024</a><div><div class=ananke-socials><a href=https://github.com/DevTown target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://chaos.social/@dev_town target=_blank rel=noopener class="mastodon ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Mastodon link" aria-label="follow on Mastodon——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67"><path d="M61.731833 16.783448C60.855064 10.336694 55.17491 5.2562169 48.441526 4.2717554 47.305526 4.1054038 43.001372 3.5 33.030833 3.5h-.07446c-9.973232.0-12.112924.6054038-13.248924.7717554C13.161526 5.2289477 7.1836569 9.7940169 5.7332999 16.317063c-.6976035 3.212462-.7720515 6.774-.6424569 10.041.1847407 4.685077.2205861 9.361923.6507292 14.027923.2973693 3.099385.8161231 6.174077 1.552377 9.201 1.3786615 5.590462 6.9594998 10.242769 12.4272688 12.140846 5.854077 1.979385 12.149615 2.307923 18.181846.949.663539-.152692 1.319846-.33 1.968693-.531769 1.464153-.460846 3.182-.976308 4.444846-1.881692.01731-.01269.03154-.02908.04154-.048.01-.01885.01562-.03977.01631-.06108v-4.521385c-308e-6-.01992-.0051-.03954-.014-.05738-.009-.01785-.02185-.03354-.03777-.04577-.01585-.01231-.03431-.02092-.05392-.02531-.01969-.0043-.04008-.0042-.05969 23e-5-3.864769.913077-7.825154 1.370769-11.798615 1.363539-6.838154.0-8.677308-3.209693-9.204-4.546-.423308-1.154846-.692154-2.359462-.799615-3.583308-.0011-.02054.0028-.04108.01115-.05992.0084-.01877.02123-.03538.03731-.04839.01615-.013.03515-.02208.05546-.02646.02031-.0045.04138-.004.06154.0012 3.800385.906846 7.696154 1.364538 11.605615 1.363538.940231.0 1.877693.0 2.818-.02454 3.931923-.109077 8.076154-.308154 11.944693-1.055385.09654-.01908.193-.03546.275769-.06 6.101923-1.159 11.908846-4.796846 12.498923-14.008846.02208-.362692.07723-3.798769.07723-4.175077.0028-1.279.416384-9.072846-.06069-13.861538zm-9.391461 22.98623H45.924141V24.225525c0-3.272462-1.378692-4.941385-4.182923-4.941385-3.082692.0-4.626769 1.974385-4.626769 5.874v8.508385H30.736757V25.15814c0-3.899615-1.546847-5.874-4.629539-5.874-2.787692.0-4.180154 1.668923-4.182923 4.941385V39.769678H15.513526V23.753755c0-3.272461.844692-5.87223 2.534-7.799384 1.742615-1.922539 4.028461-2.909693 6.865769-2.909693 3.283923.0 5.765538 1.248923 7.419923 3.744231l1.596539 2.650692 1.59923-2.650692c1.654385-2.495308 4.136-3.744231 7.414462-3.744231 2.834538.0 5.120308.987154 6.868461 2.909693 1.689385 1.925307 2.534 4.525077 2.534 7.799384z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</span></a><a href=https://dev-town.de/index.xml target=_blank rel=noopener class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" aria-label="follow on RSS——Opens in a new window"><span class=icon><svg viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>